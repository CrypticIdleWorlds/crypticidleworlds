<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Combat - Cryptic Idle Worlds</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* Keep original CSS unchanged */
    body { font-family: 'Share Tech Mono', monospace; background: url('assets/backgrounds/battle2.png') no-repeat center center fixed; background-size: cover; color: #00ff99; padding: 20px; }
    #save-bar { background-color: rgba(0, 0, 0, 0.6); padding: 10px; border-bottom: 2px solid #00ff99; position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; }
    #combat-area { display: flex; margin-top: 80px; gap: 20px; }
    #combat-style-panel { background-color: rgba(0, 0, 0, 0.6); padding: 20px; border: 2px solid #00ff99; width: 250px; }
    .style-group { margin-bottom: 20px; }
    .style-group strong img { width: 20px; vertical-align: middle; }
    #combat-display { display: flex; justify-content: space-between; gap: 40px; width: 100%; }
    #enemy-box, #player-box { background-color: rgba(0, 0, 0, 0.6); border: 2px solid #00ff99; padding: 20px; width: 50%; text-align: center; }
    #enemy-image { width: 120px; margin: 10px 0; }
    .btn { background-color: rgba(0,0,0,0.8); color: #00ff99; border: 1px solid #00ff99; padding: 10px 20px; cursor: pointer; margin-top: 10px; }
    #food-box img { width: 40px; border: 1px solid #00ff99; cursor: pointer; }
    #skills-tab { background-color: rgba(0,0,0,0.6); border: 2px solid #00ff99; padding: 16px; margin-top: 30px; }
    #combat-log { margin-top: 20px; padding: 10px; background-color: rgba(0, 0, 0, 0.6); border-top: 2px solid #00ff99; font-size: 12px; height: 120px; overflow-y: auto; }
    .level-up-message { position: fixed; top: 40%; left: 50%; transform: translate(-50%, -50%); font-size: 24px; background: #00ff99; color: #000; padding: 10px 20px; border: 2px solid #00ff99; z-index: 9999; opacity: 0; animation: flashFade 2s ease-out; }
    @keyframes flashFade { 0% { opacity: 1; } 100% { opacity: 0; } }
    /* Global tracker */
    #global-skill-tracker { background: #111; padding: 10px; color: #fff; font-size: 14px; border-top: 2px solid #00ff99; margin-top: 20px; }
    .skill-entry { margin-bottom: 8px; }
    .skill-entry .xp-bar { background: #333; height: 10px; border-radius: 5px; overflow: hidden; margin-top: 3px; }
    .skill-entry .xp-bar div { height: 100%; background: #4caf50; }
    .active-skill { background: #222; padding: 5px; border-left: 4px solid #4caf50; }
  </style>
</head>
<body>
  <div id="save-bar">
    <span id="last-save-time">Time since last save: 0s</span>
    <button onclick="saveProgress()">üíæ Cloud Save</button>
  </div>

  <h1>‚öîÔ∏è Combat Mode <button onclick="window.location.href='home.html'" class="btn" style="float:right">üõë Escape</button></h1>

  <div id="combat-area"> <!-- unchanged content here --> </div>

  <div id="skills-tab"> <!-- unchanged skills tracker --> </div>

  <div id="global-skill-tracker"></div>

  <div id="combat-log">[LOG] Combat initialized.<br /></div>
  <div id="level-up-popup" class="level-up-message"></div>

  <!-- New JS includes -->
  <script src="js/items.js"></script>
  <script src="js/masterySystem.js"></script>
  <script src="js/achievementsSystem.js"></script>
  <script src="js/combatLogSystem.js"></script>
  <script src="js/offlineProgress.js"></script>
  <script src="js/skills.js"></script>
  <script src="js/skillsSystem.js"></script>

  <!-- Existing logic -->
  <script>
    function updateCombatBackground() {
      const region = localStorage.getItem('selectedRegion') || 'Default';
      let bg = 'assets/backgrounds/battle2.png';
      if (region === 'Ashlands') bg = 'assets/backgrounds/battleashlands.png';
      else if (region === 'Cyberspire') bg = 'assets/backgrounds/battlecyberspire.png';
      else if (region === 'Wraithmarsh') bg = 'assets/backgrounds/battlewraithmarsh.png';
      else if (region === 'Zerocrypt') bg = 'assets/backgrounds/battlezerocrypt.png';
      document.body.style.background = `url('${bg}') no-repeat center center fixed`;
      document.body.style.backgroundSize = 'cover';
    }
    window.addEventListener('DOMContentLoaded', updateCombatBackground);
  </script>
  <script src="js/combat.js"></script>
</body>
</html>
